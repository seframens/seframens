using System;
using System.IO;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using Microsoft.Win32;

namespace ImageViewer
{
    public partial class MainWindow : Window
    {
        private Image _imageElement;
        private ScrollViewer _scrollViewer;
        private Slider _zoomSlider;
        private TextBlock _statusTextBlock;
        private string _currentFilePath;

        public MainWindow()
        {
            InitializeComponent();
            this.WindowState = WindowState.Maximized; // Открывать на полный экран
            InitializeUI();
        }

        private void InitializeUI()
        {
            // Создание меню
            Menu mainMenu = new Menu();
            MenuItem fileMenuItem = new MenuItem { Header = "Файл" };
            MenuItem openMenuItem = new MenuItem { Header = "Открыть" };
            MenuItem exitMenuItem = new MenuItem { Header = "Выход" };

            openMenuItem.Click += OpenMenuItem_Click;
            exitMenuItem.Click += ExitMenuItem_Click;

            fileMenuItem.Items.Add(openMenuItem);
            fileMenuItem.Items.Add(exitMenuItem);
            mainMenu.Items.Add(fileMenuItem);

            // Создание строки состояния
            _statusTextBlock = new TextBlock { Text = "Файл не открыт" };
            StatusBar statusBar = new StatusBar();
            statusBar.Items.Add(_statusTextBlock);

            // Создание элемента для отображения изображения
            _imageElement = new Image { Stretch = Stretch.None }; // Исходный размер
            _scrollViewer = new ScrollViewer
            {
                HorizontalScrollBarVisibility = ScrollBarVisibility.Auto,
                VerticalScrollBarVisibility = ScrollBarVisibility.Auto,
                Content = _imageElement
            };

            // Создание слайдера для масштабирования
            _zoomSlider = new Slider
            {
                Minimum = 0,
                Maximum = 200,
                Value = 100,
                Orientation = Orientation.Horizontal,
                Width = 200,
                Margin = new Thickness(5)
            };
            _zoomSlider.ValueChanged += ZoomSlider_ValueChanged;


            // Создание панели для размещения элементов
            DockPanel mainPanel = new DockPanel();

            // Добавление элементов на панель
            DockPanel.SetDock(mainMenu, Dock.Top);
            DockPanel.SetDock(statusBar, Dock.Bottom);
            DockPanel.SetDock(_zoomSlider, Dock.Bottom); // Размещаем слайдер над status bar
            mainPanel.Children.Add(mainMenu);
            mainPanel.Children.Add(statusBar);
            mainPanel.Children.Add(_zoomSlider);
            mainPanel.Children.Add(_scrollViewer);

            this.Content = mainPanel; // Установка контента окна
        }

        private void OpenMenuItem_Click(object sender, RoutedEventArgs e)
        {
            OpenFileDialog openFileDialog = new OpenFileDialog();
            openFileDialog.Filter = "Image files (*.bmp, *.jpg, *.jpeg, *.png)|*.bmp;*.jpg;*.jpeg;*.png|All files (*.*)|*.*";

            if (openFileDialog.ShowDialog() == true)
            {
                _currentFilePath = openFileDialog.FileName; // Сохраняем путь к файлу

                try
                {
                    BitmapImage bitmap = new BitmapImage();
                    bitmap.BeginInit();
                    bitmap.CacheOption = BitmapCacheOption.OnLoad;
                    bitmap.UriSource = new Uri(_currentFilePath);
                    bitmap.EndInit();
                    _imageElement.Source = bitmap;

                    // Обновление заголовка окна
                    Title = Path.GetFileName(_currentFilePath);

                    // Обновление строки состояния
                    FileInfo fileInfo = new FileInfo(_currentFilePath);
                    _statusTextBlock.Text = $"Размер: {fileInfo.Length} байт, Ширина: {bitmap.PixelWidth}px, Высота: {bitmap.PixelHeight}px";
                }
                catch (Exception ex)
                {
                    MessageBox.Show($"Ошибка загрузки изображения: {ex.Message}", "Ошибка");
                }

                 UpdateImageTransform();
            }
        }

        private void ExitMenuItem_Click(object sender, RoutedEventArgs e)
        {
            this.Close();
        }

        private void ZoomSlider_ValueChanged(object sender, RoutedPropertyChangedEventArgs<double> e)
        {
           UpdateImageTransform();
        }


        private void UpdateImageTransform()
        {
            if (_imageElement.Source == null) return;

            double zoomPercentage = _zoomSlider.Value / 100.0;

            ScaleTransform scaleTransform = new ScaleTransform(zoomPercentage, zoomPercentage);
            _imageElement.RenderTransform = scaleTransform;
            _imageElement.RenderTransformOrigin = new Point(0.5, 0.5); // Масштабирование относительно центра

        }
    }
}








<Window x:Class="ImageViewer.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:ImageViewer"  <!-- Замените ImageViewer на пространство имен вашего проекта -->
        mc:Ignorable="d"
        Title="MainWindow" Height="450" Width="800">

    </Window>











